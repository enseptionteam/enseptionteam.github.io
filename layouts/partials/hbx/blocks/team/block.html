{{/* layouts/partials/hbx/blocks/team/block.html */}}

{{- $block := . -}}                         {{/* In this Hugo Blox setup, `.` IS the block */}}
{{- $content := $block.content | default dict -}}
{{- $design := $block.design  | default dict -}}
{{- $data := site.Data.team -}}

{{/* TEXT FROM FRONT MATTER */}}
{{- $title := $content.title | default "Members" -}}
{{- $subtitle := $content.subtitle -}}

{{/* LAYOUT/STYLING FROM FRONT MATTER */}}
{{- $columns := $design.columns   | default "3" -}}
{{- $align   := $design.align     | default "center" -}}
{{- $nameColor := $design.name_color | default "text-white" -}}

{{/* Alignment -> Tailwind classes */}}
{{- $itemsClass := "items-center" -}}
{{- $textClass := "text-center" -}}
{{- $justifyClass := "justify-items-center" -}}

{{- if eq $align "left" -}}
  {{- $itemsClass = "items-start" -}}
  {{- $textClass = "text-left" -}}
  {{- $justifyClass = "justify-items-start" -}}
{{- else if eq $align "right" -}}
  {{- $itemsClass = "items-end" -}}
  {{- $textClass = "text-right" -}}
  {{- $justifyClass = "justify-items-end" -}}
{{- end -}}

{{/* Columns -> Tailwind grid classes (string OR number) */}}
{{- $lgColsClass := "lg:grid-cols-3" -}}
{{- if or (eq $columns "1") (eq $columns 1) -}}
  {{- $lgColsClass = "lg:grid-cols-1" -}}
{{- else if or (eq $columns "2") (eq $columns 2) -}}
  {{- $lgColsClass = "lg:grid-cols-2" -}}
{{- else if or (eq $columns "4") (eq $columns 4) -}}
  {{- $lgColsClass = "lg:grid-cols-4" -}}
{{- else if or (eq $columns "5") (eq $columns 5) -}}
  {{- $lgColsClass = "lg:grid-cols-5" -}}
{{- end -}}

<section id="{{ $block.id | default "team" }}" class="py-16">
  <div class="max-w-5xl mx-auto px-4">

    {{/* SECTION HEADING */}}
    <h2 class="text-4xl font-semibold text-center mb-2">
      {{ $title }}
    </h2>

    {{ with $subtitle }}
      <p class="text-xl text-gray-400 text-center mb-8">
        {{ . }}
      </p>
    {{ end }}

    {{ range $group := $data.groups }}
      <div class="mt-12">
        <h3 class="text-2xl font-semibold text-center mb-6">
          {{ $group.title }}
        </h3>

        <div class="grid gap-10 sm:grid-cols-1 md:grid-cols-2 {{ $lgColsClass }} {{ $justifyClass }}">

          {{ range $id := $group.members }}
            {{ $person := index $data.people $id }}
            {{ if not $person }}
              {{ warnf "team block: no person found for id %q" $id }}
            {{ else }}

              <div class="flex flex-col {{ $itemsClass }} {{ $textClass }} max-w-xs">

                {{ with $person.avatar }}
                  <img src="{{ . | relURL }}"
                       alt="Photo of {{ $person.name }}"
                       class="w-32 h-32 rounded-full object-cover shadow mb-4">
                {{ end }}

                <h4 class="text-lg font-semibold {{ $nameColor }}">
                  {{ $person.name }}
                </h4>

                {{ with $person.role }}
                  <p class="text-sm text-gray-400 mb-2">
                    {{ . }}
                  </p>
                {{ end }}

                {{ with $person.interests }}
                  <p class="text-sm text-gray-400 mb-3">
                    {{ delimit . ", " }}
                  </p>
                {{ end }}

                {{ with $person.profiles }}
                  <div class="flex gap-4 mt-2 text-lg">
                    {{ range . }}
                      {{- $iconName := .icon -}}
                      {{- $url := .url -}}
                      {{- $label := .label | default $iconName -}}
                      {{- if $iconName }}
                        {{- $shortcode := printf "{{< icon name=\"%s\" >}}" $iconName -}}
                        <a href="{{ $url }}" aria-label="{{ $label }}" class="text-gray-400 hover:text-gray-200">
                          {{ $.Page.RenderString $shortcode | safeHTML }}
                        </a>
                      {{- end -}}
                    {{ end }}
                  </div>
                {{ end }}

              </div>
            {{ end }}
          {{ end }}

        </div>
      </div>
    {{ end }}

  </div>
</section>
