{{/* layouts/partials/hbx/blocks/team/block.html */}}

{{- $ctx := . -}}

{{/* Get the Hugo page object from the context dict */}}
{{- $page := $ctx.page | default $ctx.Page -}}

{{- $data := site.Data.team | default dict -}}

<section class="py-16 bg-transparent">
  <div class="container mx-auto px-4">

    {{/* Hard-coded section title & subtitle */}}
    <div class="mb-12">
      <h2 class="text-4xl font-semibold text-center mb-2">
        Team
      </h2>
      <p class="text-xl text-gray-400 text-center mb-8">
        Our Team
      </p>
    </div>

    {{- if not $data.groups }}
      <p class="text-center text-gray-400">
        No team data found. Make sure <code>data/team.yaml</code> defines <code>groups</code> and <code>people</code>.
      </p>
    {{- else }}

      {{- range $group := $data.groups }}
        <div class="mb-12">

          {{- with $group.title }}
            <h3 class="text-2xl font-semibold text-center mb-6">
              {{ . }}
            </h3>
          {{- end }}

          {{/* 4 columns on large screens */}}
          <div class="grid gap-10 sm:grid-cols-1 md:grid-cols-3 lg:grid-cols-5 justify-items-center">
            {{- range $id := $group.members }}
              {{- $person := index $data.people $id -}}
              {{- if $person }}

                <article class="flex flex-col items-center text-center max-w-xs">

                  {{/* Avatar */}}
                  {{- with $person.avatar }}
                    <div class="mb-4">
                      <img
                        src="{{ . | relURL }}"
                        alt="{{ $person.name }}"
                        class="w-32 h-32 rounded-full object-cover mx-auto"
                      />
                    </div>
                  {{- end }}

                  {{/* Name */}}
                  <h4 class="text-lg font-semibold text-white">
                    {{ $person.name }}
                  </h4>

                  {{/* Role */}}
                  {{- with $person.role }}
                    <p class="text-sm text-gray-400 mt-1">
                      {{ . }}
                    </p>
                  {{- end }}

                  {{/* Organizations (optional) */}}
                  {{- with $person.organizations }}
                    <p class="text-xs text-gray-500 mt-1">
                      {{ delimit . ", " }}
                    </p>
                  {{- end }}

                  {{/* Social / URL links as visible text chips; also *try* icon shortcode if it ever works */}}
                                    {{/* Social / URL links ... */}}
                  {{- with $person.profiles }}
                    <div class="flex flex-wrap gap-2 mt-4 justify-center">
                      {{- range . }}
                        {{- $url   := .url   | default "" -}}
                        {{- $icon  := .icon  | default "" -}}
                        {{- $label := .label | default "" -}}
                        {{- if $url }}
                          {{- $iconHTML := "" -}}
                          {{- if and $icon $page }}
                            {{- $shortcode := printf "{{< icon name=\"%s\" >}}" $icon -}}
                            {{- $iconHTML = $page.RenderString $shortcode -}}
                          {{- end }}

                          <a
                            href="{{ $url }}"
                            class="inline-flex items-center gap-1 px-3 py-1 rounded-full border border-gray-400 text-xs text-gray-400 hover:bg-gray-200 hover:border-gray-200"
                            target="_blank"
                            rel="noopener noreferrer"
                          >
                            {{- if $iconHTML }}
                              <span class="inline-block">
                                {{ $iconHTML | safeHTML }}
                              </span>
                            {{- end }}
                            <span>{{ $label }}</span>
                          </a>
                        {{- end }}       
                      {{- end }}         
                    </div>
                  {{- end }}             

                </article>

              {{- end }}               
            {{- end }}                 
          </div>                       
        </div>                         

      {{- end }}                       

    {{- end }}                         
  </div>                               
</section>
